{"version":3,"file":"index.js","sources":["../src/js/elements.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export default {\n  form: document.querySelector('.js-search-form'),\n  gallery: document.querySelector('.js-gallery'),\n  input: document.querySelector('.js-search-input'),\n  loader: document.querySelector('.js-loader'),\n  loadMoreBtn: document.querySelector('.js-load-more-btn'),\n};\n","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nconst API_KEY = '45493659-807fc3e2fcb62ed82bdbe6cc7';\n\nasync function searchImages({ q, page = 1, per_page } = {}) {\n  return (\n    await axios.get('/', {\n      params: {\n        key: API_KEY,\n        q: encodeURIComponent(q),\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page,\n      },\n    })\n  ).data;\n}\n\nexport { searchImages };\n","function showSearchResults(array) {\n  return array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"152\" />\n            <ul class=\"description\">\n              <li class=\"description-items\">\n                <span class=\"accent\">Likes </span>${likes}\n              </li>\n              <li class=\"description-items\">\n                <span class=\"accent\">Views </span>${views}\n              </li>\n              <li class=\"description-items\">\n                <span class=\"accent\">Comments </span>${comments}\n              </li>\n              <li class=\"description-items\">\n                <span class=\"accent\">Downloads </span>${downloads}\n              </li>\n            </ul>\n          </a>\n        </li>`\n    )\n    .join('');\n}\n\nfunction showElement(element) {\n  element.classList.remove('hidden');\n}\n\nfunction hideElement(element) {\n  element.classList.add('hidden');\n}\n\nexport { showSearchResults, showElement, hideElement };\n","import elements from './js/elements';\nimport { searchImages } from './js/pixabay-api';\nimport {\n  showSearchResults,\n  showElement,\n  hideElement,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst photosGallery = new simpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  total_pages: 0,\n};\n\nelements.form.addEventListener('submit', searchHandler);\n\nasync function searchHandler(event) {\n  event.preventDefault();\n  elements.gallery.innerHTML = '';\n  params.page = 1;\n  elements.loadMoreBtn.removeEventListener('click', loadMoreHandler);\n  hideElement(elements.loadMoreBtn);\n  params.q = elements.input.value.trim();\n  if (params.q === '') {\n    return iziToast.error({\n      message: 'Search field can not be empty!',\n      position: 'topCenter',\n      timeout: 3000,\n      messageColor: '#fafafb',\n      backgroundColor: '#ef4040',\n      iconUrl: './error.svg',\n      progressBarColor: '#b51b1b',\n      maxWidth: '432px',\n    });\n  }\n  showElement(elements.loader);\n  try {\n    const data = await searchImages(params);\n    if (data.hits.length === 0) {\n      elements.input.value = '';\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 3000,\n        messageColor: '#fafafb',\n        backgroundColor: '#ef4040',\n        iconUrl: './error.svg',\n        progressBarColor: '#b51b1b',\n        maxWidth: '432px',\n      });\n    } else {\n      params.total_pages = Math.ceil(data.totalHits / params.per_page);\n      if (params.total_pages > 1) {\n        showElement(elements.loadMoreBtn);\n        elements.loadMoreBtn.addEventListener('click', loadMoreHandler);\n      } else {\n        hideElement(elements.loadMoreBtn);\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          timeout: 3000,\n          maxWidth: '432px',\n        });\n        elements.loadMoreBtn.removeEventListener('click', loadMoreHandler);\n      }\n      elements.input.value = '';\n      elements.gallery.innerHTML = showSearchResults(data.hits);\n      photosGallery.refresh();\n    }\n  } catch (err) {\n    iziToast.error({\n      message: `Something went wrong... Error: ${err}`,\n      position: 'topCenter',\n      timeout: 3000,\n      messageColor: '#fafafb',\n      backgroundColor: '#ef4040',\n      iconUrl: './error.svg',\n      progressBarColor: '#b51b1b',\n      maxWidth: '432px',\n    });\n  } finally {\n    hideElement(elements.loader);\n  }\n}\n\nasync function loadMoreHandler() {\n  showElement(elements.loader);\n  params.page += 1;\n  hideElement(elements.loadMoreBtn);\n  try {\n    const data = await searchImages(params);\n    elements.gallery.insertAdjacentHTML(\n      'beforeend',\n      showSearchResults(data.hits)\n    );\n    photosGallery.refresh();\n    const galleryItem = document.querySelector('.gallery-item');\n    const galleryItemHeight = galleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: galleryItemHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (err) {\n    iziToast.error({\n      message: `Something went wrong... Error: ${err}`,\n      position: 'topCenter',\n      timeout: 3000,\n      messageColor: '#fafafb',\n      backgroundColor: '#ef4040',\n      iconUrl: './error.svg',\n      progressBarColor: '#b51b1b',\n      maxWidth: '432px',\n    });\n  } finally {\n    hideElement(elements.loader);\n    if (params.page === params.total_pages) {\n      elements.loadMoreBtn.removeEventListener('click', loadMoreHandler);\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 3000,\n        maxWidth: '432px',\n      });\n    } else {\n      showElement(elements.loadMoreBtn);\n    }\n  }\n}\n"],"names":["elements","axios","API_KEY","searchImages","q","page","per_page","showSearchResults","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","showElement","element","hideElement","photosGallery","simpleLightbox","params","searchHandler","event","loadMoreHandler","iziToast","data","err","galleryItemHeight"],"mappings":"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"}